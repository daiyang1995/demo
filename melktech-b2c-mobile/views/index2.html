<!DOCTYPE html><html lang="en"><head></head><body><%-include("./commonJs.html")%><%-include("./commonCss.html")%><title>产品详情</title><link rel="stylesheet" href="<%=localurl%><%=projectUrl%>stylesheets/page/index2.css"><%-include("./wxShareJSConfig.html")%><script type="text/babel">$(document).ready(function(){  const insurantRuleJson = eval(<%-data.insurantRuleJson%>); const insureModeJson =eval(<%-data.insureModeJson%>); const planClassAndDutyJson = eval(<%-JSON.stringify(data.planClassAndDuty)%>) ; const priceJson = eval(<%-JSON.stringify(data.priceJson)%>); <% if(typeof data.insJson !== 'undefined' && data.insJson ){%>const insJson = eval(<%-JSON.stringify(data.insJson)%>); for(let i = 0 ; insJson.length>i; i++){ let ins = insJson[i] , htmlText =""; if("logo" in ins){ for(let j = 0 ; ins.logo.length>j ; j++){ let img = ins.logo[j]; htmlText += `<img src="${img}">`; } } if("text" in ins){ $("#ins").append(`<div class="oneIns">${htmlText}<span class="insText">${ins.text}</span></div>`); } }<% } %><% if(typeof data.saleArea !== 'undefined' && data.saleArea ){%>let saleArea = eval(<%-data.saleArea%>);  $("#selectSaleAreaButton").append(`<div id="selectSaleArea" class="selectLine ui-grid-b"><span class="ui-block-a">${saleArea.label}</span> <span class="ui-block-b">请选择</span> <span class="ui-block-c"></span></div>`); let saleAreaJson = eval(saleArea.item); let selectSaleAreaButton = new MobileSelect({ trigger: `#selectSaleArea`, title:`${saleArea.label}`, wheels: [ {data: saleAreaJson} ], reloadPosition : true, triggerDisplayData : false, position: [0],  callback:function(idx , data ){ let text = ""; for(var i in data){ text+= data[i].value+"-"; } $($(this)[0].trigger).find(".ui-block-b").html(text.substring(0,text.length-1)) ; let tempJson = saleAreaJson; for(let i in selectSaleAreaButton.getIndexArr()){ let idx = selectSaleAreaButton.getIndexArr()[i]; tempJson = tempJson[idx].childs ? tempJson[idx].childs:tempJson[idx]; } if("remark" in tempJson && tempJson.remark != ""){ if($("#saleAreaRemark").length > 0){ $("#saleAreaRemark").html(tempJson.remark); }else{ $("#selectSaleAreaButton").after(`<div id="saleAreaRemark">${tempJson.remark}</div>`); } }else{ $("#saleAreaRemark").remove(); } } });<%}%>let insurantRuleArray = [];  let planClassAndDutyJsonArray = [];  let allDimensionCombine ="";  let price = ""; let noFound = true; let shark = new SharkTip({ needShark: true });   for(var i in insurantRuleJson){ if(insurantRuleJson[i].items.length > 1){ $("#selectButton").append(`<div id="${insurantRuleJson[i].ename}" class="selectLine ui-grid-b" data-value="${insurantRuleJson[i].items[0].id}"><span class="ui-block-a">${insurantRuleJson[i].name}</span> <span class="ui-block-b">${insurantRuleJson[i].items[0].label}</span> <span class="ui-block-c"></span></div>`); insurantRuleArray[i] = new MobileSelect({ trigger: `#${insurantRuleJson[i].ename}`, title:`${insurantRuleJson[i].name}`, wheels: [ {data: eval(insurantRuleJson[i].items)} ], keyMap: { id:'id', value: 'label' }, reloadPosition : true, beforeSelect: function(data , trigger){ return beforeSelect(data , trigger) }, triggerDisplayData : false, position: [0],  callback:function(idx , data ){ $($(this)[0].trigger).attr("data-value",data[0].id); $($(this)[0].trigger).find(".ui-block-b").html(data[0].label) ; } }); }else{ $("#selectButton").append(`<div id="${insurantRuleJson[i].ename}" class="selectLine ui-grid-a" data-value="${insurantRuleJson[i].items[0].id}"><span class="ui-block-a">${insurantRuleJson[i].name}</span> <span class="ui-block-b">${insurantRuleJson[i].items[0].label}</span></div>`); } };  if(insureModeJson.items.length > 1){ $("#selectModeButton").append(`<div id="${insureModeJson.ename}" class="selectLine ui-grid-b" data-value="${insureModeJson.items[0].id}"><span class="ui-block-a">${insureModeJson.name}</span> <span class="ui-block-b">${insureModeJson.items[0].label}</span> <span class="ui-block-c"></span></div>`); let selectModeButton = new MobileSelect({ trigger: `#${insureModeJson.ename}`, title:`${insureModeJson.name}`, wheels: [ {data: eval(insureModeJson.items)} ], keyMap: { id:'id', value: 'label' }, reloadPosition : true, beforeSelect: function(data , trigger){ return beforeSelect(data , trigger) }, triggerDisplayData : false, position: [0],  callback:function(idx , data ){ $($(this)[0].trigger).attr("data-value",data[0].id); $($(this)[0].trigger).find(".ui-block-b").html(data[0].label) ; } }); }else{ $("#selectModeButton").append(`<div id="${insureModeJson.ename}" class="selectLine ui-grid-a" data-value="${insureModeJson.items[0].id}"><span class="ui-block-a">${insureModeJson.name}</span> <span class="ui-block-b">${insureModeJson.items[0].label}</span></div>`); }  $(".quotaShow").each(function(idx , obj){ let thisJquery = this; let thisType = $(thisJquery).attr("dataType"); let thisIdx = $(thisJquery).attr("idx"); let thisId = $(thisJquery).attr("id"); if("class"== thisType){ if(planClassAndDutyJson[thisIdx].items.length == 0 ){ return true; }else{ planClassAndDutyJsonArray[idx] = new MobileSelect({ trigger: `#${thisId}`, title:`${planClassAndDutyJson[thisIdx].planClassName}`, wheels: [ {data: planClassAndDutyJson[thisIdx].items } ], reloadPosition : true, beforeSelect: function(data , trigger){ return beforeSelect(data , trigger) }, triggerDisplayData : false, position: [0],  callback:function(idx , data ){ $($(this)[0].trigger).attr("data-value",data[0].id); $($(this)[0].trigger).html(data[0].value) ; } }); $(thisJquery).attr("data-value",planClassAndDutyJson[thisIdx].items[0].id); $(thisJquery).html(planClassAndDutyJson[thisIdx].items[0].value); $(thisJquery).addClass("haveQuota"); } }else if("duty" == thisType){ let parentIdx = $(thisJquery).attr("parentIdx"); planClassAndDutyJsonArray[idx] = new MobileSelect({ trigger: `#${thisId}`, title:`${planClassAndDutyJson[parentIdx].second_plan[thisIdx].planDutyName}`, wheels: [ {data: planClassAndDutyJson[parentIdx].second_plan[thisIdx].items } ], reloadPosition : true, beforeSelect:function(data , trigger){ return beforeSelect(data , trigger) }, triggerDisplayData : false, position: [0],  callback:function(idx , data ){ $($(this)[0].trigger).attr("data-value",data[0].id); $($(this)[0].trigger).html(data[0].value) ; } }); $(thisJquery).attr("data-value",planClassAndDutyJson[parentIdx].second_plan[thisIdx].items[0].id); $(thisJquery).html(planClassAndDutyJson[parentIdx].second_plan[thisIdx].items[0].value); $(thisJquery).addClass("haveQuota"); }; });  function beforeSelect(data , trigger){ let dataValue = []; var found = false; $("#selectButton .selectLine").each(function(){ if(trigger == this){ dataValue.push(data[0].id); }else{ dataValue.push($(this).attr("data-value")); } }); $("#selectModeButton .selectLine").each(function(){ if(trigger == this){ dataValue.push(data[0].id); }else{ dataValue.push($(this).attr("data-value")); } }); $("#jobs .haveQuota").each(function(){ if(trigger == this){ dataValue.push(data[0].id); }else{ dataValue.push($(this).attr("data-value")); } }); for(let i in priceJson) {  if(i.length ==dataValue.toString().length && dataValue.filter(function (data) {return i.indexOf(data) > -1;}).length == dataValue.length){  found = true; allDimensionCombine = i; price = priceJson[i].discountFee; let originFee = priceJson[i].originFee; if(originFee != null){ originFee = `<span class="originFee">(￥${originFee.toString().indexOf(".") > 0 ?originFee:originFee+".00"}元)</span>`; }else{ originFee = ""; } $(".footer .ui-block-a").html(`￥${(price.toString().indexOf(".") > 0?price+"元":price+".00元") + originFee}`);  noFound = false; return false; }; }; noFound = true; $(".footer .ui-block-a").html(""); shark.show("选项组合不存在,请选择正确的人员属性,保障年限和保额"); return true; }  $(".jobsType").on("vclick" , ".downArrow" , function (e) { e.preventDefault(); let thisJquery = this ; let idx = $(thisJquery).attr("idx"); let detailType = $(thisJquery).attr("detailType"); $(thisJquery).removeClass("downArrow"); $(thisJquery).addClass("upArrow"); let jobsDetailClassName = "jobsDetail"+detailType+idx; $(thisJquery).parents(".jobsType").find("."+jobsDetailClassName).show(); });  $(".jobsType").on("vclick" , ".upArrow" , function (e) { e.preventDefault(); let thisJquery = this ; let idx = $(thisJquery).attr("idx"); let detailType = $(thisJquery).attr("detailType"); $(thisJquery).addClass("downArrow"); $(thisJquery).removeClass("upArrow"); let jobsDetailClassName = "jobsDetail"+detailType+idx; $(thisJquery).parents(".jobsType").find("."+jobsDetailClassName).hide(); });  $(".introduce").on("vclick",".introduceLine",function(e){ e.preventDefault(); let thisJquery = this; window.location.href="<%=localurl%><%=projectUrl%>"+$(thisJquery).attr("data-action")+"?uniqueCode=<%=uniqueCode%>"; });  $(".question").on("vclick",".questionMore",function (e) { e.preventDefault(); $(this).hide(); $(".question .questionLineMore").show(); }); beforeSelect();  $(".footer").on("vclick", ".coverBtn", function (e) { e.preventDefault(); beforeSelect(); if(noFound){ shark.show("请选择正确的组合"); return false; } if($("#selectSaleArea").length != 0 && $("#selectSaleArea .ui-block-b").html() =="请选择"){ shark.show(`请选择${$("#selectSaleArea .ui-block-a").html()}`); return false; } var formAction = "<%=localurl%><%=projectUrl%>goToHealthInfo?uniqueCode=<%=uniqueCode%>"; var form1 = document.createElement("form"); form1.id = "VirtualForm"; form1.name = "VirtualForm"; document.body.appendChild(form1); $("#VirtualForm").css("display", "none"); let input0 = document.createElement("input"); input0.type = "text";input0.name = "price";input0.value = price;  form1.appendChild(input0); let input1 = document.createElement("input"); input1.type = "text";input1.name = "allDimensionCombine";input1.value = allDimensionCombine;  form1.appendChild(input1); if($("#selectSaleArea").length != 0 ){ let input2 = document.createElement("input"); input2.type = "text";input2.name = "assa";input2.value = $("#selectSaleArea .ui-block-b").html();  form1.appendChild(input2); } form1.method = "POST"; form1.action = formAction; form1.submit(); });  new HorizontalScroll({ speed:50, scroll_JqueryDom : ".jobsType .secondPlan .horizontalScroll" });  $(".header").on("vclick",".shareIcon",function (e) { e.preventDefault(); $("body").append(`<div id="screen"><img src="<%=localurl%><%=projectUrl%>images/share.png"></div>`); });  $("body").on("vclick","#screen , #screen img",function (e) { e.preventDefault(); $("#screen").remove(); }); });</script><div class="header"><%if(typeof canShare !== 'undefined'){%><span class="icon-carat-b-onwer shareIcon"></span><%}%> <span class="title">产品详情</span> <a class="header-save tel" data-role="none" href="tel:<%=data.telephone%>"></a></div><div class="bodyContent"><div class="littleHeader"><img class="banner" src="<%=data.banner[0]%>"><div class="detail"><div class="detailTitle weight"><span><%=data.planName%></span></div><div class="detailPrice"><span>￥<%=data.price.discountFee%>元</span><span class="priceTip">起</span><%if(data.price.originFee != null ){%><span class="originFee">(￥<%=data.price.originFee%>元)</span><%}%></div><div class="detailInfo"><span>最高保障</span><span><%=data.maxQuota%></span></div><% if(data.stockLimit == "true"){ %><div class="detailStock">剩余<span class="orange"><%=data.stock%></span>份</div><% } %></div></div><% if(typeof data.insJson !== 'undefined' && data.insJson ) {%><div id="ins"></div><%}%><div id="selectButton"></div><div id="selectModeButton"></div><% if(typeof data.saleArea !== 'undefined' && data.saleArea ) {%><div id="selectSaleAreaButton"></div><%}%><div id="jobs" class="jobs"><div class="jobsTitle weight">保障责任</div><% data.planClassAndDuty.forEach(function (t,classIdx) { %><div class="jobsType"><div class="jobsTipTitle ui-grid-b"><span class="ui-block-a"><%=t.planClassName%><% if(t.planClassDayAmount != null && t.planClassDayAmount != "" ){%>（<%=t.planClassDayAmount%>天）<%}%></span> <span id="class<%=t.planClassCode%>" datatype="class" idx="<%=classIdx%>" class="ui-block-b quotaShow"></span><% if(t.detail && t.planClassDetail !="" ){%> <span class="ui-block-c downArrow" idx="<%=classIdx%>" detailtype="Class"></span><%}%></div><div class="jobsDetail jobsDetailClass<%=classIdx%>"><%-t.planClassDetail%></div><% t.second_plan.forEach(function (ts,dutyIdx) { %><div class="ui-grid-b secondPlan"><span class="ui-block-a horizontalScroll"><%=ts.planDutyName%><% if(ts.planDutyDayAmount != null && ts.planDutyDayAmount != "" ){%>（最高<%=ts.planDutyDayAmount%>天）<%}%></span> <span id="duty<%=ts.planDutyCode%>" datatype="duty" parentidx="<%=classIdx%>" idx="<%=dutyIdx%>" class="ui-block-b quotaShow"></span><% if(ts.planDutyDetail !="" ){%> <span class="ui-block-c downArrow" idx="<%=classIdx%><%=dutyIdx%>" detailtype="Duty"></span><%}%></div><div class="jobsDetail jobsDetailDuty<%=classIdx%><%=dutyIdx%>"><%-ts.planDutyDetail%></div><%})%></div><%})%></div><div class="adv"><div class="advTitle weight">产品优势</div><% if(typeof data.introductionPicList !== 'undefined' ){ data.introductionPicList.forEach(function (t,idx) {%><img src="<%=t.url%>"><%})}%><% if (typeof data.introduction !== 'undefined' ){ %><%-data.introduction%><% } %></div><div class="introduce"><div class="introduceLine ui-grid-b" data-action="insuranceProcess"><span class="ui-block-a">投保流程</span> <span class="ui-block-b">查看</span> <span class="ui-block-c"></span></div><div class="introduceLine ui-grid-b" data-action="insuranceClauses"><span class="ui-block-a">保险条款</span> <span class="ui-block-b">查看</span> <span class="ui-block-c"></span></div><div class="introduceLine ui-grid-b" data-action="claimProcess"><span class="ui-block-a">理赔流程</span> <span class="ui-block-b">查看</span> <span class="ui-block-c"></span></div><div class="introduceLine ui-grid-b" data-action="policyStatement"><span class="ui-block-a">保单说明</span> <span class="ui-block-b">查看</span> <span class="ui-block-c"></span></div></div><div class="question"><div class="questionTitle weight">常见问题</div><% if(typeof data.questions !== 'undefined'){ data.questions.forEach(function (t,idx) {%><%if(idx == 3){%><div class="questionMore">查看更多</div><%}%><div class="questionLine <%if(idx > 2){%> questionLineMore <%}%>"><h3><%=t.question%></h3><p><%-t.answer%></p></div><%})}%></div></div><div class="footer ui-grid-a"><span class="ui-block-a"></span><% if((data.stockLimit == 'false')|| (data.stockLimit == 'true' && data.stock != '0')){ %> <span class="ui-block-b coverBtn">立即投保</span><% }else{ %> <span class="ui-block-b sellOut">敬请期待</span><% } %></div></body></html>